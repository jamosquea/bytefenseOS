#!/bin/bash
# Bytefense OS - Script de Pre-instalaciÃ³n

set -e

echo "ğŸ›¡ï¸ Preparando instalaciÃ³n de Bytefense OS..."

# Verificar que se ejecuta como root
if [ "$EUID" -ne 0 ]; then
    echo "âŒ Este paquete debe instalarse como root"
    exit 1
fi

# Verificar sistema compatible
if [ ! -f /etc/debian_version ] && [ ! -f /etc/lsb-release ]; then
    echo "âŒ Sistema no compatible. Requiere Debian/Ubuntu"
    exit 1
fi

# Verificar arquitectura
ARCH=$(dpkg --print-architecture)
if [ "$ARCH" != "amd64" ] && [ "$ARCH" != "arm64" ] && [ "$ARCH" != "armhf" ]; then
    echo "âš ï¸ Arquitectura $ARCH puede no ser completamente compatible"
fi

# Crear usuario del sistema si no existe
if ! id "bytefense" &>/dev/null; then
    echo "ğŸ‘¤ Creando usuario del sistema bytefense..."
    useradd -r -s /bin/bash -d /opt/bytefense -c "Bytefense OS System User" bytefense
fi

echo "âœ… Pre-instalaciÃ³n completada"
exit 0